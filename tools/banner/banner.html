<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>バナー作成ツール</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="banner.css">
</head>
<body>
    <div class="banner-tool">
        <!-- ヘッダー -->
        <header class="tool-header">
            <div class="header-left">
                <h1 class="tool-title">バナー作成</h1>
            </div>
            <div class="header-center">
                <div class="canvas-size-selector">
                    <button class="size-btn active" data-size="1080x1080">スクエア</button>
                    <button class="size-btn" data-size="1080x1920">縦長</button>
                </div>
            </div>
            <div class="header-right">
                <button class="btn btn-secondary" id="exportAllBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7,10 12,15 17,10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    全てダウンロード
                </button>
            </div>
        </header>

        <!-- タブバー -->
        <div class="tab-bar">
            <div class="tabs-container" id="tabsContainer">
                <button class="tab active" data-project-id="1">
                    <span class="tab-name">プロジェクト 1</span>
                    <button class="tab-close" data-project-id="1">×</button>
                </button>
            </div>
            <button class="new-tab-btn" id="newTabBtn" title="新規プロジェクト">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
            </button>
            <div class="history-dropdown">
                <button class="history-btn" id="historyBtn" title="プロジェクト履歴">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12,6 12,12 16,14"/>
                    </svg>
                </button>
                <div class="history-menu" id="historyMenu">
                    <div class="history-header">プロジェクト履歴</div>
                    <div class="history-list" id="historyList"></div>
                </div>
            </div>
        </div>

        <!-- メインエリア -->
        <div class="tool-main">
            <!-- 左: 参考デザイン選択パネル -->
            <aside class="favorite-banner-panel" id="favoriteBannerPanel">
                <button class="panel-toggle-btn" id="panelToggleBtn" title="パネルを開閉">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15,18 9,12 15,6"/>
                    </svg>
                </button>
                <div class="panel-header">
                    <h2>参考デザイン</h2>
                    <button class="add-banner-btn" id="addFavoriteBannerBtn" title="新規登録">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                    </button>
                </div>
                <div class="panel-select-row">
                    <select class="project-select" id="favoriteBannerProjectSelect">
                        <option value="debt">債務整理</option>
                        <option value="unemployment">失業保険</option>
                        <option value="clinic">クリニック</option>
                    </select>
                </div>
                <div class="favorite-banner-list" id="favoriteBannerList">
                    <!-- 動的に生成 -->
                </div>
            </aside>

            <!-- 中央: バナーギャラリー -->
            <div class="banner-gallery">
                <div class="gallery-header">
                    <h2 class="gallery-title">生成されたバナー</h2>
                    <span class="banner-count" id="bannerCount">0枚</span>
                </div>
                <div class="gallery-content" id="galleryContent">
                    <div class="gallery-empty" id="galleryEmpty">
                        <div class="empty-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <circle cx="8.5" cy="8.5" r="1.5"/>
                                <polyline points="21,15 16,10 5,21"/>
                            </svg>
                        </div>
                        <p>チャットでバナーを生成すると<br>ここに表示されます</p>
                    </div>
                </div>
            </div>

            <!-- 右: チャットパネル -->
            <aside class="chat-panel-wide">
                <!-- 事前設定パネル -->
                <div class="preset-panel collapsed">
                    <div class="preset-header" id="presetHeader">
                        <span class="preset-title">任意設定</span>
                        <button class="preset-toggle" id="presetToggle" title="パネルを開閉">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6,9 12,15 18,9"/>
                            </svg>
                        </button>
                    </div>
                    <div class="preset-content" id="presetContent">
                        <div class="preset-row">
                            <label class="preset-label">ターゲット</label>
                            <input type="text" class="preset-input" id="presetTarget" placeholder="例: 30代男性、借金に悩む会社員">
                        </div>
                        <div class="preset-row">
                            <label class="preset-label">訴求ポイント</label>
                            <input type="text" class="preset-input" id="presetAppeal" placeholder="例: 無料相談、スピード対応">
                        </div>
                        <div class="preset-row">
                            <label class="preset-label">トーン＆マナー</label>
                            <input type="text" class="preset-input" id="presetTone" placeholder="例: 信頼感、安心感、明るい">
                        </div>
                        <div class="preset-row">
                            <label class="preset-label">詳細</label>
                            <textarea class="preset-textarea" id="presetDetails" placeholder="例: 青系の落ち着いた色合い、人物写真を使用"></textarea>
                        </div>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <div class="chat-message system">
                        <div class="message-content">
                            <p>👋 バナーに入れる文言を教えてください</p>
                            <p class="hint">左パネルから参考デザインを選択した上で、キャッチコピーや訴求内容を入力してください。</p>
                        </div>
                    </div>
                </div>

                <div class="chat-input-area">
                    <div class="input-options">
                        <label class="option-label">
                            <select id="projectSelect">
                                <option value="" selected>案件選択</option>
                                <option value="saimu">債務整理</option>
                                <option value="shitsugyou">失業保険</option>
                                <option value="clinic">クリニック</option>
                            </select>
                        </label>
                        <label class="option-label">
                            <select id="bannerSizeSelect">
                                <option value="1080x1080" selected>1080×1080</option>
                                <option value="1080x1920">1080×1920</option>
                                <option value="1200x628">1200×628</option>
                                <option value="300x250">300×250</option>
                                <option value="728x90">728×90</option>
                            </select>
                        </label>
                        <label class="option-label">
                            <select id="generateCount">
                                <option value="1" selected>1枚</option>
                                <option value="2">2枚</option>
                                <option value="3">3枚</option>
                                <option value="4">4枚</option>
                            </select>
                        </label>
                    </div>
                    <div class="input-row">
                        <textarea class="chat-input" id="chatInput" placeholder="バナーに入れたいキャッチコピーや文言を入力..."></textarea>
                        <button class="chat-send-btn" id="chatSendBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13"/>
                                <polygon points="22,2 15,22 11,13 2,9"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- 修正コメントモーダル -->
    <div class="comment-modal" id="commentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>修正コメントを追加</h4>
                <button class="modal-close" id="commentModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <textarea class="modal-textarea" id="commentText" placeholder="修正内容を入力..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="commentCancel">キャンセル</button>
                <button class="btn btn-primary" id="commentConfirm">追加</button>
            </div>
        </div>
    </div>

    <!-- 参考デザイン保存モーダル -->
    <div class="modal" id="favoriteBannerSaveModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>参考デザインを登録</h3>
                <button class="modal-close" id="favoriteBannerSaveModalClose">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="favoriteBannerName">バナー名</label>
                    <input type="text" id="favoriteBannerName" placeholder="例: 債務整理_成功パターン">
                </div>
                
                <!-- 画像サイズ表示（自動検出） -->
                <div class="form-group" id="bannerSizeGroup" style="display: none;">
                    <label>検出されたサイズ</label>
                    <div class="size-display">
                        <span id="bannerSizeDisplay">-</span>
                    </div>
                </div>
                
                <!-- 画像アップロードエリア -->
                <div class="form-group">
                    <label>バナー画像 <span class="required">*</span></label>
                    <div class="banner-upload-area" id="bannerUploadArea">
                        <input type="file" id="bannerImageInput" accept="image/*" hidden>
                        <div class="upload-placeholder" id="bannerUploadPlaceholder">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <circle cx="8.5" cy="8.5" r="1.5"/>
                                <polyline points="21,15 16,10 5,21"/>
                            </svg>
                            <span>クリックして画像を選択</span>
                            <span class="upload-hint">PNG, JPG, WEBP対応</span>
                        </div>
                        <div class="upload-preview" id="bannerUploadPreview" style="display: none;">
                            <img id="bannerPreviewImage" src="" alt="プレビュー">
                            <button class="remove-preview-btn" id="removeBannerPreview">×</button>
                        </div>
                    </div>
                </div>
                

            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="favoriteBannerSaveModalCancel">キャンセル</button>
                <button class="btn btn-primary" id="favoriteBannerSaveModalConfirm" disabled>保存</button>
            </div>
        </div>
    </div>

    <!-- 参考デザイン編集モーダル -->
    <div class="modal" id="favoriteBannerEditModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>参考デザインを編集</h3>
                <button class="modal-close" id="favoriteBannerEditModalClose">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="editFavoriteBannerName">バナー名</label>
                    <input type="text" id="editFavoriteBannerName">
                    <input type="hidden" id="editFavoriteBannerFilename">
                </div>
                <div class="form-group">
                    <label>バナー画像</label>
                    <div class="banner-preview-display">
                        <img id="editBannerPreviewImage" src="" alt="バナー画像">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="favoriteBannerEditModalCancel">キャンセル</button>
                <button class="btn btn-primary" id="favoriteBannerEditModalConfirm">更新</button>
            </div>
        </div>
    </div>

    <!-- 参考デザイン削除確認モーダル -->
    <div class="modal" id="favoriteBannerDeleteModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>参考デザインを削除</h3>
                <button class="modal-close" id="favoriteBannerDeleteModalClose">×</button>
            </div>
            <div class="modal-body">
                <p>「<span id="deleteBannerName"></span>」を削除しますか？</p>
                <p class="delete-warning">この操作は取り消せません。</p>
                <input type="hidden" id="deleteBannerFilename">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="favoriteBannerDeleteModalCancel">キャンセル</button>
                <button class="btn btn-danger" id="favoriteBannerDeleteModalConfirm">削除</button>
            </div>
        </div>
    </div>

    <script src="banner.js"></script>
</body>
</html>
