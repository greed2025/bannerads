# Mixboard プロジェクトタブ機能 確認依頼

**作成日**: 2025-12-19  
**確認担当者**: 先輩  
**対象コード**: 現在のワーキングディレクトリ（Git uncommitted）  
**保存方式**: localStorage（`mixboard_projects_v3` キー）

---

## 確認URL
```
http://localhost:8080/tools/mixboard/mixboard.html
```

---

## 事前準備

> テスト前に以下を実行してストレージを初期化してください

1. Chrome DevToolsを開く（F12）
2. Application → Local Storage → localhost:8080
3. `mixboard_projects_v3` を右クリック → Delete
4. ページをリロード（F5）

---

## 確認項目

### 1. タブ表示確認（初期状態）
| 項目 | 期待結果 |
|------|----------|
| タブバー表示 | ヘッダー中央にタブバーが表示 |
| 初期タブ | 「Project 1」タブが1つ作成される |
| 閉じるボタン | タブ右端に「×」ボタンが表示 |
| 追加ボタン | タブバー右端に「+」ボタンが表示 |

### 2. タブ追加
| 操作 | 期待結果 |
|------|----------|
| 「+」ボタンクリック | 新規タブが追加される |
| 新規タブ名 | 「Project N」（連番）で作成 |
| フォーカス | 追加したタブに自動で切り替わる |

### 3. タブ切り替え
| 操作 | 期待結果 |
|------|----------|
| 別タブをクリック | キャンバスが切り替わる |
| 前プロジェクト | 要素が残らず完全にクリア |
| 元タブに戻る | 元の内容が復元される |

### 4. タブ名編集
| 操作 | 期待結果 |
|------|----------|
| タブ名を**ダブルクリック** | テキスト選択状態で編集モード |
| 文字入力後 Enter | 名前確定、編集モード終了 |
| Escape キー | 元の名前に戻り編集キャンセル |
| 空文字入力で確定 | 元の名前を維持（空にならない） |

### 5. タブ削除
| 操作 | 期待結果 |
|------|----------|
| ×ボタンクリック | タブが削除される |
| 最後の1つを削除 | 削除されない＋トースト「最後のプロジェクトは削除できません」 |
| 現在タブ削除 | 隣のタブに自動切り替え |

### 6. データ永続化
| 操作 | 期待結果 |
|------|----------|
| ページリロード | タブ一覧が復元 |
| プロジェクト名 | 編集した名前が保持 |
| キャンバス内容 | 画像・テキスト要素が復元 |

### 7. Undo/Redo（履歴）
| 操作 | 期待結果 |
|------|----------|
| Cmd+Z（Mac）/ Ctrl+Z（Win） | 直前の操作が元に戻る |
| Cmd+Shift+Z / Ctrl+Shift+Z | やり直し |
| タブ切り替え後Undo | 各プロジェクトの履歴が独立 |
| リロード後Undo | 履歴復元＋Undo可能（localStorageに保存） |

---

## 確認手順

### 手順1: 基本動作確認
```
1. localStorage初期化（事前準備参照）
2. Mixboardを開く
3. 初期状態で「Project 1」タブがあることを確認
4. 「+」ボタンで2個タブを追加（計3個）
5. 各タブで以下を実行:
   - 左パネルから画像をドラッグ＆ドロップ
   または
   - 下部チャットバーでプロンプト入力→生成
6. タブを切り替えて、内容が正しく切り替わるか確認
```

### 手順2: タブ名編集
```
1. タブ名「Project 1」をダブルクリック
2. 「テストプロジェクト」と入力
3. Enterキーで確定
4. 別タブをダブルクリック
5. 何か入力後、Escapeキー
6. 元の名前に戻ることを確認
```

### 手順3: 履歴確認
```
1. 任意のプロジェクトで画像を追加
2. 画像を移動
3. Cmd+Z（Mac）で移動が元に戻る
4. Cmd+Z で画像追加が元に戻る
5. 別タブに切り替え
6. 元のタブに戻る
7. Cmd+Shift+Z で画像追加がやり直される
```

### 手順4: 永続化確認
```
1. 複数タブを作成し、それぞれ編集
2. タブ名をカスタマイズ
3. ページをリロード（F5）
4. タブ一覧・内容・履歴が復元されるか確認
5. Cmd+Z で履歴が機能するか確認
```

---

## 発見した問題点

| No | 現象 | 再現手順 | 備考 |
|----|------|----------|------|
| 1  |      |          |      |
| 2  |      |          |      |
| 3  |      |          |      |

---

## 修正済みバグ一覧

> **対象**: 現在のワーキングディレクトリ（未コミット）  
> **保存方式**: localStorage（`mixboard_projects_v3` キー）のみ

| 優先度 | 問題 | 修正内容 |
|--------|------|----------|
| 重大 | キャンバスクリア失敗 | `.element` → `.canvas-element` |
| 重大 | IndexedDB競合 | IndexedDB完全削除、localStorage一本化 |
| 高 | 履歴混入 | プロジェクト単位で履歴管理 |
| 高 | 履歴未永続化 | saveProjectsで履歴も保存 |
| 中 | タブ名編集 | ダブルクリックで編集に変更 |

---

## 確認結果

- [ ] **OK** - 問題なし
- [ ] **NG** - 問題あり（上記に記載）

**コメント**:
```

```

**確認者**: ______________ **日付**: ______________
