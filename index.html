<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banner Studio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="mixboard-app">
        <!-- ヘッダー -->
        <header class="mixboard-header">
            <div class="header-left">
                <input type="text" class="project-name-input" id="projectName" value="Untitled">
            </div>
            <div class="header-right">
                <a class="btn btn-secondary" href="settings.html">API設定</a>
            </div>
        </header>

        <!-- メインコンテンツ -->
        <div class="mixboard-main">
            <!-- 中央: キャンバスエリア -->
            <div class="canvas-area" id="canvasArea">
                <!-- 左サイドツールバー -->
                <div class="left-toolbar" id="leftToolbar">
                    <button class="tool-btn active" id="toolSelect" title="選択ツール" data-tool="select">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/>
                        </svg>
                    </button>
                    <button class="tool-btn" id="toolHand" title="ハンドツール" data-tool="hand">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 11V6a2 2 0 0 0-2-2 2 2 0 0 0-2 2v5"/>
                            <path d="M14 10V4a2 2 0 0 0-2-2 2 2 0 0 0-2 2v6"/>
                            <path d="M10 10.5V6a2 2 0 0 0-2-2 2 2 0 0 0-2 2v8"/>
                            <path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8H9a8 8 0 0 1-8-8V8a2 2 0 1 1 4 0"/>
                        </svg>
                    </button>
                </div>

                <!-- キャンバスコンテナ -->
                <div class="canvas-wrapper" id="canvasWrapper">
                    <div class="canvas-container" id="canvasContainer">
                        <div class="canvas-empty-state" id="canvasEmptyState">
                            <span class="empty-text">Add your text</span>
                        </div>
                        <!-- 範囲選択矩形 -->
                        <div class="selection-box" id="selectionBox" style="display: none;"></div>
                    </div>
                </div>

                <!-- 画像選択時フローティングツールバー -->
                <div class="element-toolbar" id="elementToolbar" style="display: none;">
                    <button class="element-tool-btn" id="btnEdit" title="編集">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                        </svg>
                    </button>
                    <button class="element-tool-btn" id="btnDownload" title="ダウンロード">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </button>
                    <button class="element-tool-btn delete" id="btnDelete" title="削除">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3,6 5,6 21,6"/>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                    </button>
                </div>

                <!-- 下部チャットバー（画像生成AI用） -->
                <div class="bottom-chat-container" id="bottomChatContainer">
                    <!-- 選択画像プレビュー（入力バーの上に表示） -->
                    <div class="selected-image-preview-bar" id="selectedImagePreviewBar" style="display: none;">
                        <div class="preview-content">
                            <div class="preview-thumbnails" id="previewThumbnails">
                                <!-- 動的にサムネイルが追加される -->
                            </div>
                            <span class="preview-label" id="previewLabel">選択中</span>
                            <button class="preview-close-btn" id="previewCloseBtn" title="選択解除">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- 設定パネル -->
                    <div class="generator-settings-panel" id="generatorSettingsPanel" style="display: none;">
                        <div class="settings-header">
                            <span class="settings-title">生成設定</span>
                            <button class="settings-close-btn" id="settingsCloseBtn" title="閉じる">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                            </button>
                        </div>
                        <div class="settings-content">
                            <div class="settings-section">
                                <label class="settings-label">生成枚数</label>
                                <div class="count-presets">
                                    <button class="count-preset-btn active" data-count="1">1枚</button>
                                    <button class="count-preset-btn" data-count="2">2枚</button>
                                    <button class="count-preset-btn" data-count="3">3枚</button>
                                    <button class="count-preset-btn" data-count="4">4枚</button>
                                </div>
                            </div>
                            <div class="settings-section">
                                <label class="settings-label">画像サイズ</label>
                                <div class="size-presets">
                                    <button class="size-preset-btn active" data-width="1080" data-height="1080">1080×1080</button>
                                    <button class="size-preset-btn" data-width="900" data-height="1600">900×1600</button>
                                    <button class="size-preset-btn" data-width="628" data-height="1200">628×1200</button>
                                </div>
                            </div>
                            <div class="custom-size">
                                <label>カスタムサイズ</label>
                                <div class="custom-size-inputs">
                                    <input type="number" id="customWidthInput" placeholder="幅" min="256" max="2048" step="64">
                                    <span>×</span>
                                    <input type="number" id="customHeightInput" placeholder="高さ" min="256" max="2048" step="64">
                                    <button class="apply-custom-btn" id="applyCustomSizeBtn">適用</button>
                                </div>
                            </div>
                            <div class="current-size-display">
                                現在: <strong id="currentSizeDisplay">1枚 / 1080×1080</strong>
                            </div>
                        </div>
                    </div>
                    
                    <!-- チャットバー本体 -->
                    <div class="bottom-chat-bar" id="bottomChatBar">
                        <button class="chat-plus-btn" id="chatPlusBtn" title="画像追加">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                        </button>
                        <div class="chat-input-wrapper">
                            <button class="settings-btn" id="settingsBtn" title="設定">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="4" y1="21" x2="4" y2="14"/>
                                    <line x1="4" y1="10" x2="4" y2="3"/>
                                    <line x1="12" y1="21" x2="12" y2="12"/>
                                    <line x1="12" y1="8" x2="12" y2="3"/>
                                    <line x1="20" y1="21" x2="20" y2="16"/>
                                    <line x1="20" y1="12" x2="20" y2="3"/>
                                    <line x1="1" y1="14" x2="7" y2="14"/>
                                    <line x1="9" y1="8" x2="15" y2="8"/>
                                    <line x1="17" y1="16" x2="23" y2="16"/>
                                </svg>
                            </button>
                            <input type="text" class="chat-input" id="generatorInput" placeholder="どんなバナーを作りますか？">
                            <button class="chat-send-btn" id="generatorSendBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <polyline points="12 16 16 12 12 8"/>
                                    <line x1="8" y1="12" x2="16" y2="12"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ズームコントロール -->
                <div class="zoom-controls" id="zoomControls">
                    <button class="zoom-btn" id="zoomOut" title="縮小">−</button>
                    <span class="zoom-level" id="zoomLevel">100%</span>
                    <button class="zoom-btn" id="zoomIn" title="拡大">+</button>
                </div>
            </div>

        </div>
    </div>

    <!-- 修正モードテンプレート -->
    <template id="revisionOverlayTemplate">
        <div class="revision-overlay">
            <div class="revision-container">
                <div class="revision-header">
                    <h3>画像編集</h3>
                    <button class="cancel-btn" data-action="revision-cancel">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                        キャンセル
                    </button>
                </div>
                <div class="revision-content">
                    <div class="revision-image-wrapper">
                        <img data-role="revision-image" src="" alt="編集中">
                        <div class="revision-layer" data-role="revision-layer"></div>
                    </div>
                </div>
                <div class="revision-tools">
                    <div class="color-palette">
                        <button class="palette-btn active" data-color="red" style="background: #ff4d4d;"></button>
                        <button class="palette-btn" data-color="green" style="background: #22c55e;"></button>
                        <button class="palette-btn" data-color="blue" style="background: #3b82f6;"></button>
                        <button class="palette-btn" data-color="yellow" style="background: #eab308;"></button>
                    </div>
                </div>
                <div class="revision-footer">
                    <button class="btn btn-secondary" data-action="revision-cancel">キャンセル</button>
                    <button class="btn btn-primary" data-action="revision-save">保存</button>
                </div>
            </div>
        </div>
    </template>

    <script src="js/mixboard.js"></script>
</body>
</html>
